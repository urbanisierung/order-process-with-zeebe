FROM node:10-alpine

ENV OPZ_CLIENT_ID=$OPZ_CLIENT_ID
ENV OPZ_CLIENT_SECRET=$OPZ_CLIENT_SECRET
ENV OPZ_AUDIENCE=$OPZ_AUDIENCE
ENV CC_CLUSTER_UUID=$CC_CLUSTER_UUID
ENV CC_BASE_URL=$CC_BASE_URL
ENV CC_CLIENT_ID=$CC_CLIENT_ID
ENV CC_CLIENT_SECRET=$CC_CLIENT_SECRET
ENV CC_AUTH_URL=$CC_AUTH_URL

WORKDIR /app
COPY package*.json ./

RUN npm i

COPY . .

EXPOSE 8080

RUN npm run build

CMD [ "npm", "run", "dist" ]